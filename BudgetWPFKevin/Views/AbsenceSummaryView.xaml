<UserControl x:Class="BudgetWPFKevin.Views.AbsenceSummaryView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:BudgetWPFKevin.ViewModels">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Resources/Styles.xaml"/>
            </ResourceDictionary.MergedDictionaries>

            <!-- DataTemplate för frånvaroposter -->
            <DataTemplate x:Key="AbsenceRecordTemplate">
                <Border Style="{StaticResource DataTemplateBorder}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" 
                                   Text="{Binding Date, StringFormat=\{0:yyyy-MM-dd\}}" 
                                   Style="{StaticResource TransactionDateText}"/>

                        <TextBlock Grid.Column="1" 
                                   Text="{Binding DisplayTypeName}" 
                                   Style="{StaticResource TransactionCategoryText}"/>

                        <TextBlock Grid.Column="2" 
                                   Text="{Binding Hours, StringFormat=N1}" 
                                   Style="{StaticResource TransactionDescriptionText}"
                                   HorizontalAlignment="Left"/>
                    </Grid>
                </Border>
            </DataTemplate>

        </ResourceDictionary>
    </UserControl.Resources>

    <Border Padding="10" BorderBrush="#DDDDDD" BorderThickness="0,1,0,0">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="2*"/>
            </Grid.ColumnDefinitions>

            <!-- Vänster: sammanfattning frånvaro -->
            <StackPanel Grid.Column="0" Margin="{StaticResource SectionMargin}">
                <TextBlock Text="Frånvarosummering" Style="{StaticResource SectionHeaderText}"/>

                <UniformGrid Columns="3" Rows="1">
                    <Border Style="{StaticResource SummaryCard}">
                        <StackPanel>
                            <TextBlock Text="Totalt frånvaroavdrag"/>
                            <TextBlock Text="{Binding AbsenceDeduction, StringFormat={}{0:C0}, ConverterCulture=sv-SE}" 
                                       Foreground="Red"/>
                        </StackPanel>
                    </Border>

                    <Border Style="{StaticResource SummaryCard}">
                        <StackPanel>
                            <TextBlock Text="Totalt ersättning (80%)"/>
                            <TextBlock Text="{Binding AbsenceCompensation, StringFormat={}{0:C0}, ConverterCulture=sv-SE}" 
                                       Foreground="Green"/>
                        </StackPanel>
                    </Border>

                    <Border Style="{StaticResource SummaryCard}">
                        <StackPanel>
                            <TextBlock Text="Nettoeffekt frånvaro"/>
                            <TextBlock Text="{Binding AbsenceNetEffect, StringFormat={}{0:C0}, ConverterCulture=sv-SE}"/>
                        </StackPanel>
                    </Border>
                </UniformGrid>
            </StackPanel>

            <!-- Höger: lista med AbsenceRecord -->
            <StackPanel Grid.Column="1" Margin="{StaticResource SectionMargin}">
                <TextBlock Text="Frånvaroposter (VAB / Sjuk)" Style="{StaticResource SectionHeaderText}"/>

                <!-- Header för kolumner -->
                <Border Style="{StaticResource ColumnHeaderBorder}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" 
                                   Text="Datum" 
                                   Style="{StaticResource ColumnHeaderText}"/>

                        <TextBlock Grid.Column="1" 
                                   Text="Typ" 
                                   Style="{StaticResource ColumnHeaderText}"/>

                        <TextBlock Grid.Column="2" 
                                   Text="Timmar" 
                                   Style="{StaticResource ColumnHeaderText}"/>
                    </Grid>
                </Border>

                <!-- ListBox med data -->
                <ListBox ItemsSource="{Binding AbsenceRecords}"
                         ItemTemplate="{StaticResource AbsenceRecordTemplate}"
                         MaxHeight="120"/>
            </StackPanel>
        </Grid>
    </Border>
</UserControl>